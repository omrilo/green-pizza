name: Test Docker Login

on:
  workflow_dispatch:

jobs:
  test-login:
    runs-on: ubuntu-latest
    
    steps:
      - name: Show what we're using
        run: |
          echo "Registry: ${{ vars.ARTIFACTORY_URL }}"
          echo "Username: ${{ secrets.JF_USER }}"
          echo "Token first 10 chars: ${TOKEN:0:10}..."
        env:
          TOKEN: ${{ secrets.ARTIFACTORY_ACCESS_TOKEN }}

      - name: Try Docker Login (Method 1 - admin user)
        run: |
          echo "${{ secrets.ARTIFACTORY_ACCESS_TOKEN }}" | docker login ${{ vars.ARTIFACTORY_URL }} -u ${{ secrets.JF_USER }} --password-stdin
        continue-on-error: true

      - name: Try Docker Login (Method 2 - token as username)
        run: |
          echo "${{ secrets.ARTIFACTORY_ACCESS_TOKEN }}" | docker login ${{ vars.ARTIFACTORY_URL }} -u ${{ secrets.ARTIFACTORY_ACCESS_TOKEN }} --password-stdin
        continue-on-error: true

      - name: Try Docker Login (Method 3 - just token)
        run: |
          docker login ${{ vars.ARTIFACTORY_URL }} -u token -p ${{ secrets.ARTIFACTORY_ACCESS_TOKEN }}
